fill in code bits from thesis.. 
